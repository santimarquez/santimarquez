---
import TimelineItem from '../ui/TimelineItem.astro';
import { experience } from '../../data/experience';

interface Props {
  locale: 'en' | 'es';
  t: (key: string) => string;
}

const { locale, t } = Astro.props;
const roleKeys: Record<string, { role: string; company: string; period: string; summary: string }> = {
  alertaCoches: { role: 'experience.alertaCoches.role', company: 'experience.alertaCoches.company', period: 'experience.alertaCoches.period', summary: t('experience.alertaCoches.summary') },
  internations: { role: 'experience.internations.role', company: 'experience.internations.company', period: 'experience.internations.period', summary: t('experience.internations.summary') },
  enterticket: { role: 'experience.enterticket.role', company: 'experience.enterticket.company', period: 'experience.enterticket.period', summary: t('experience.enterticket.summary') },
  gtmotive: { role: 'experience.gtmotive.role', company: 'experience.gtmotive.company', period: 'experience.gtmotive.period', summary: t('experience.gtmotive.summary') },
};
---

<section id="experience" class="px-6 py-20 md:py-28" aria-labelledby="experience-heading">
  <div class="mx-auto max-w-5xl">
    <p class="text-xs font-medium uppercase tracking-wider text-charcoal-light dark:text-slate-500">{t('section.journey')}</p>
    <h2 id="experience-heading" class="mt-2 text-3xl font-bold text-charcoal dark:text-slate-100 md:text-4xl">
      {t('experience.title')}
    </h2>
    <div class="mt-12">
      {experience.map((role, i) => {
        const keys = roleKeys[role.id];
        if (!keys) return null;
        return (
          <TimelineItem
            roleKey={keys.role}
            companyKey={keys.company}
            periodKey={keys.period}
            summary={keys.summary}
            bullets={role.bullets}
            teamSize={role.teamSize ?? null}
            scale={role.scale ?? null}
            t={t}
            isLast={i === experience.length - 1}
          />
        );
      })}
    </div>
  </div>
</section>
