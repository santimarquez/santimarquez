---
import ProjectCard from '../ui/ProjectCard.astro';

interface Props {
  locale: 'en' | 'es';
  t: (key: string) => string;
}

const { locale, t } = Astro.props;

// With prefixDefaultLocale: false, English is at root (/projects/...), Spanish at /es/projects/...
function projectHref(locale: 'en' | 'es', path: string): string {
  const base = path.startsWith('/') ? path : `/${path}`;
  return locale === 'es' ? `/es${base}` : base;
}

function getTag(t: (k: string) => string, key: string): string {
  const val = t(key);
  return val && !val.startsWith('projects.') ? val : (key.includes('alertaCoches') ? 'Scale Solutions' : 'Performance');
}

const alertaCochesHref = projectHref(locale, '/projects/alertaCoches/');
const santimarquezEsHref = projectHref(locale, '/projects/santimarquez-es/');
---

<section id="projects" class="px-6 py-20 md:py-28" aria-labelledby="projects-heading">
  <div class="mx-auto max-w-5xl">
    <p class="text-xs font-medium uppercase tracking-wider text-charcoal-light dark:text-slate-500">{t('section.portfolio')}</p>
    <h2 id="projects-heading" class="mt-2 text-3xl font-bold text-charcoal dark:text-slate-100 md:text-4xl">
      {t('projects.title')}
    </h2>

    <div class="mt-12 grid gap-8 md:grid-cols-2">
      <ProjectCard
        title={t('projects.alertaCoches.title')}
        description={t('projects.alertaCoches.shortDescription')}
        tag={getTag(t, 'projects.alertaCoches.tag')}
        href={alertaCochesHref}
      >
        <div slot="visual" class="flex h-full min-h-[200px] items-center justify-center overflow-hidden bg-slate-100 dark:bg-slate-700">
          <img loading="lazy" src="/projects/alertaCoches-card.jpeg" alt="AlertaCoches.es — car listing" class="h-full w-full object-cover object-center" width="640" height="360" />
        </div>
      </ProjectCard>

      <ProjectCard
        title={t('projects.thisSite.title')}
        description={t('projects.thisSite.shortDescription')}
        tag={getTag(t, 'projects.thisSite.tag')}
        href={santimarquezEsHref}
      >
        <div slot="visual" class="flex h-full min-h-[200px] items-center justify-center overflow-hidden bg-slate-100 dark:bg-slate-700">
          <img loading="lazy" src="/projects/santimarquez-card.png" alt="Santi Márquez" class="h-full w-full object-cover object-top" width="640" height="360" />
        </div>
      </ProjectCard>
    </div>
  </div>
</section>
